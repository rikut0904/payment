<!DOCTYPE html>
<html>

<head>
  <title><%= title %></title>
  <link rel='stylesheet' href='/stylesheets/style.css' />
</head>

<body data-skip-auth-redirect="true">
  <div class="layout">
    <%- include('../partials/header', { title }) %>
    <div class="content">
      <section class="card">
        <h2>カードを登録</h2>
        <% if (errorMessage) { %>
          <div class="alert alert-error"><%= errorMessage %></div>
        <% } %>
        <form class="form-grid" method="post" action="/card/add">
          <div class="form-field">
            <label for="cardName">カード名 <span class="required">*</span></label>
            <input type="text" id="cardName" name="cardName" value="<%= formValues.cardName || '' %>" placeholder="例: メインカード" required>
          </div>
          <div class="form-field">
            <label for="cardType">カード種別</label>
            <select id="cardType" name="cardType">
              <% (cardTypes || []).forEach(function(type) { %>
                <option value="<%= type.value %>" <%= (formValues.cardType || 'credit') === type.value ? 'selected' : '' %>>
                  <%= type.label %>
                </option>
              <% }); %>
            </select>
          </div>
          <div class="form-field">
            <label for="cardBrand">ブランド</label>
            <select id="cardBrand" name="cardBrand">
              <% (cardBrands || []).forEach(function(brand) { %>
                <option value="<%= brand %>" <%= (formValues.cardBrand || 'その他') === brand ? 'selected' : '' %>><%= brand %></option>
              <% }); %>
            </select>
          </div>
          <div class="form-field">
            <label for="last4Digits">カード番号（下4桁）</label>
            <input type="text" id="last4Digits" name="last4Digits" value="<%= formValues.last4Digits || '' %>" placeholder="1234" pattern="[0-9]{4}" maxlength="4" inputmode="numeric">
          </div>
          <div class="form-field" data-credit-field>
            <label for="closingDay">締め日</label>
            <input type="number" id="closingDay" name="closingDay" value="<%= formValues.closingDay || '' %>" min="1" max="31" placeholder="例: 25">
          </div>
          <div class="form-field" data-credit-field>
            <label for="paymentDay">支払日</label>
            <input type="number" id="paymentDay" name="paymentDay" value="<%= formValues.paymentDay || '' %>" min="1" max="31" placeholder="例: 10">
          </div>
          <div class="form-field" data-credit-field>
            <label for="limitAmount">利用上限額 (JPY)</label>
            <input type="number" id="limitAmount" name="limitAmount" value="<%= formValues.limitAmount || '' %>" min="0" step="1000" placeholder="例: 100000">
          </div>
          <div class="form-actions">
            <button type="submit">登録する</button>
          </div>
        </form>
        <div class="actions" style="margin-top: 24px;">
          <a href="/card" class="btn btn-outline">一覧に戻る</a>
        </div>
      </section>
    </div>
    <footer>
      <p>&copy; 2025 <%= projectName %>. All rights reserved.</p>
    </footer>
  </div>
  <script id="firebase-config" type="application/json"><%- JSON.stringify(firebaseConfig || {}) %></script>
  <script type="module" src="/javascripts/firebase-auth.js" defer></script>
  <script type="module" src="/javascripts/card-actions.js" defer></script>
</body>

</html>
